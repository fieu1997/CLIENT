<!DOCTYPE html>
<html lang="vi">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>HSO Map Viewer</title>
	<link rel="stylesheet" href="https://rsms.me/inter/inter.css">
	<style>
		:root {
			--bg-color: #1a1a1a;
			--surface-color: #2a2a2a;
			--primary-color: #4CAF50;
			--primary-hover: #5cb85c;
			--text-color: #f0f0f0;
			--text-muted: #888;
			--border-color: #444;
			--font-family: 'Inter', sans-serif;
		}
		html { font-family: var(--font-family); }
		body {
			background-color: var(--bg-color);
			color: var(--text-color);
			margin: 0;
			font-family: var(--font-family);
			display: flex;
			height: 100vh;
			overflow: hidden;
		}
		.app-container {
			display: flex;
			width: 100%;
			height: 100%;
		}
		.sidebar {
			width: 350px;
			min-width: 300px;
			background-color: var(--surface-color);
			padding: 1.5rem;
			border-right: 1px solid var(--border-color);
			display: flex;
			flex-direction: column;
			gap: 1.5rem;
			overflow-y: auto;
			box-sizing: border-box;
		}
		header h1 {
			margin: 0 0 0.5rem 0;
			font-size: 1.75rem;
			color: var(--primary-color);
		}
		p.description {
			color: var(--text-muted);
			margin: 0 0 1rem 0;
			font-size: 0.9rem;
		}
		h2 {
			font-size: 1.1rem;
			font-weight: 600;
			border-bottom: 2px solid var(--primary-color);
			padding-bottom: 0.5rem;
			margin: 0 0 1rem 0;
		}
		.control-group {
			background-color: #222;
			padding: 1rem;
			border-radius: 6px;
			border: 1px solid var(--border-color);
		}
		.file-input-group { margin-bottom: 1rem; }
		.file-input-group label {
			display: block;
			margin-bottom: 0.5rem;
			font-weight: 500;
		}
		input[type="file"], input[type="number"], select, input[type="text"], textarea {
			width: 100%;
			background-color: #3e3e3e;
			color: var(--text-color);
			border: 1px solid var(--border-color);
			padding: 0.5rem;
			border-radius: 4px;
			box-sizing: border-box;
			font-size: 0.9rem;
		}
		input[type="file"]::file-selector-button {
			background-color: #555;
			color: var(--text-color);
			border: none;
			padding: 0.5rem 1rem;
			border-radius: 4px;
			cursor: pointer;
			transition: background-color 0.2s;
			margin-right: 1rem;
		}
		input[type="file"]::file-selector-button:hover { background-color: #666; }

		.action-button {
			width: 100%;
			background-color: var(--primary-color);
			color: white;
			border: none;
			padding: 0.75rem 1.2rem;
			border-radius: 4px;
			font-family: var(--font-family);
			font-weight: 600;
			cursor: pointer;
			transition: background-color 0.2s, opacity 0.2s;
			font-size: 1rem;
		}
		.action-button:hover:not(:disabled) { background-color: var(--primary-hover); }
		.action-button:disabled { background-color: #555; opacity: 0.6; cursor: not-allowed; }
		.log-entries {
			flex-grow: 1;
			overflow-y: auto;
			background-color: var(--bg-color);
			padding: 0.75rem;
			border-radius: 4px;
			border: 1px solid var(--border-color);
			font-family: 'Courier New', Courier, monospace;
			font-size: 0.85rem;
			display: flex;
			flex-direction: column-reverse;
			min-height: 150px;
		}
		.log-entry { margin-bottom: 0.25rem; line-height: 1.4; color: #ccc; word-break: break-word; }
		.log-timestamp { color: var(--text-muted); margin-right: 0.5rem; }

		#canvas-container {
			flex-grow: 1;
			position: relative;
			background-color: #111;
			display: flex;
			justify-content: center;
			align-items: center;
		}
		#map-canvas { display: block; background-color: var(--bg-color); cursor: grab; }
		#map-canvas.grabbing { cursor: grabbing; }
		#welcome-message { color: var(--text-muted); text-align: center; font-size: 1.2rem; }
		.grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem; }
		.inline { display: flex; gap: 0.5rem; align-items: center; }
		.small-muted { color: var(--text-muted); font-size: 0.8rem; }

		/* NPC Modal */
		#npc-editor-modal {
			display: none;
			position: absolute;
			left: 50%;
			top: 50%;
			transform: translate(-50%, -50%);
			background: #222;
			border: 1px solid var(--border-color);
			border-radius: 6px;
			padding: 16px;
			z-index: 1000;
			min-width: 420px;
			max-width: 540px;
			color: var(--text-color);
			box-shadow: 0 10px 30px rgba(0,0,0,0.6);
		}
		#npc-editor-modal h3 { margin: 0 0 12px 0; }
		#npc-editor-form label { font-size: 12px; color: #aaa; display: block; margin-bottom: 4px; }
		#npc-editor-form .field { margin-bottom: 8px; }
		#npc-editor-actions { display: flex; gap: 8px; margin-top: 8px; }
		.icon-preview { width: 48px; height: 48px; border: 1px solid var(--border-color); display:flex; align-items:center; justify-content:center; }
		/* Top toolbar and floating panel */
		#top-toolbar { position: fixed; top: 0; left: 0; right: 0; z-index: 1000; background: var(--surface-color); border-bottom: 1px solid var(--border-color); display: flex; gap: 8px; align-items: center; padding: 8px 12px; }
		#top-toolbar .mode-button { background: #3a3a3a; color: var(--text-color); border: 1px solid var(--border-color); border-radius: 4px; padding: 6px 10px; cursor: pointer; font-weight: 600; }
		#top-toolbar .mode-button.active { background: var(--primary-color); border-color: var(--primary-color); color: #fff; }
		#top-toolbar .toolbar-group { display: flex; gap: 8px; }
		.app-container { margin-top: 48px; }
		.floating-panel { position: absolute; top: 80px; left: 420px; width: 420px; height: 360px; background: #1f1f1f; border: 1px solid var(--border-color); border-radius: 6px; box-shadow: 0 10px 30px rgba(0,0,0,0.6); z-index: 1200; display: flex; flex-direction: column; resize: both; overflow: hidden; }
		.floating-header { display: flex; align-items: center; justify-content: space-between; background: #2b2b2b; padding: 6px 10px; cursor: move; border-bottom: 1px solid var(--border-color); }
		.floating-title { font-weight: 700; color: var(--text-color); }
		.floating-controls { display: flex; gap: 6px; }
		.floating-controls button { background: #444; color: var(--text-color); border: 1px solid var(--border-color); border-radius: 4px; padding: 4px 8px; cursor: pointer; }
		.floating-controls button:hover { background: #555; }
		.floating-content { flex: 1; overflow: auto; padding: 10px; }
		.floating-panel.minimized { height: auto; }
		.floating-panel.minimized .floating-content { display: none; }
		.floating-content::-webkit-scrollbar { width: 8px; height: 8px; }
		.floating-content::-webkit-scrollbar-thumb { background: #555; border-radius: 4px; }
		/* Hide sidebar to simplify UI */
		.sidebar { display: none; }
	</style>
</head>
<body>
	<!-- __BODY__ -->
	<script type="module">
	//__SCRIPT__
	</script>
</body>
</html>